#!/bin/bash

# Function to show how to use the script
usage() {
    echo "Usage: $0 -s source_folder -d destination_folder"
    echo "  -s  Folder to back up"
    echo "  -d  Where to save the backup"
    echo "  -h  Show help"
}

# Get options from the user
while getopts ":s:d:h" opt; do
    case ${opt} in
        s)
            SOURCE="$OPTARG"
            ;;
        d)
            DESTINATION="$OPTARG"
            ;;
        h)
            usage
            exit 0
            ;;
        \?)
            echo "Invalid option: -$OPTARG"
            usage
            exit 1
            ;;
    esac
done

# Check if source and destination are provided
if [ -z "$SOURCE" ] || [ -z "$DESTINATION" ]; then
    echo "Error: You need to specify both source and destination folders."
    usage
    exit 1
fi

# Make sure the source folder exists
if [ ! -d "$SOURCE" ]; then
    echo "Error: Source folder not found!"
    exit 1
fi

# Add date to the backup folder name
DATE=$(date +%Y-%m-%d)
BACKUP_FOLDER="$DESTINATION/backup-$(basename $SOURCE)-$DATE"

# Create the backup
mkdir -p "$BACKUP_FOLDER"
cp -r "$SOURCE"/* "$BACKUP_FOLDER/"

echo "Backup of $SOURCE created in $BACKUP_FOLDER."
